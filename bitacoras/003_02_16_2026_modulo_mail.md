# Bitácora 003_02_16_2026 hora 11:24:15 modulo_mail

## Qué fue lo que se hizo
- Se implementó el módulo `backup_mail.sh` que respalda el perfil completo de Thunderbird al disco de backup usando `rsync`.
- A diferencia de los módulos de GitHub y Drive, este módulo no realiza la sincronización de correos — Thunderbird ya lo hace vía IMAP. El módulo solo copia el perfil local resultante.
- Se verifica que el directorio fuente (`~/.thunderbird/`) exista antes de ejecutar.
- Se busca al menos un directorio `ImapMail/` dentro del perfil para confirmar que hay cuentas IMAP configuradas. Si no hay, registra un WARN pero continúa (el perfil puede tener contactos y calendario valiosos).
- Se usa `rsync -a --delete` para crear un espejo exacto del perfil, excluyendo `.parentlock` (archivo de lock de Thunderbird que no debe copiarse).
- Se agregaron variables en `config.env`: `BACKUP_MAIL_ORIGEN` (directorio fuente, `$HOME/.thunderbird`) y `BACKUP_MAIL_DIR` (directorio destino).
- Previo a la implementación, se configuró la cuenta Gmail (`rodanmuro@gmail.com`) en Thunderbird con IMAP/OAuth2, confirmando la sincronización de carpetas: INBOX, Sent, Drafts, Archives, Personal, Posgrado, Recibos, Trabajo, Viaje y carpetas de Gmail.

Archivos modificados: `src/modulos/backup_mail.sh`, `src/config.env`.

## Para qué se hizo
- Implementar el tercer componente real del sistema de backups (Fase 4), permitiendo respaldar el perfil de Thunderbird que contiene los correos sincronizados de Gmail, contactos y calendario.

## Qué problemas se presentaron
- Thunderbird no tenía ninguna cuenta de correo configurada al momento de iniciar la fase. El perfil existía pero no había directorio `ImapMail/` ni configuración IMAP en `prefs.js`.

## Cómo se resolvieron
- Se pausó la implementación hasta que el usuario configuró manualmente la cuenta Gmail en Thunderbird (IMAP, OAuth2, puerto 993, SSL/TLS). Una vez confirmada la sincronización (6.2MB de índices, 20 carpetas), se procedió con la implementación y pruebas del módulo.

## Qué continúa
- Fase 5: Configurar servicio systemd para ejecución automática al encender el equipo.

*(Archivos clave: [backup_mail.sh](../src/modulos/backup_mail.sh), [config.env](../src/config.env))*
